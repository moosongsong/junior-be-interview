# 서블릿의 라이프 사이클

## 서블릿의 라이프 사이클

![서블릿생명주기](https://user-images.githubusercontent.com/79966015/181659912-292afcf2-88b8-4f6b-80a3-fa9f7d2a1c13.PNG)

1. 클라이언트의 요청이 들어오면 컨테이너는 해당 서블릿이 메모리에 있는 지 확인하고, 없을 경우 init()메서드를 호출하여 메모리에 적제합니다. init()은 처음 한번만 실행되기 때문에, 서블릿의 스레드에서
   공통적으로 사용해야 하는 것이 있다면 오버라이딩 하여 구현하면 됩니다. 실행 중 서블릿이 변경될 경우, 기존 서블릿을 destroy()하고 init()을 통해 새로운 내용을 다시 메모리에 적재합니다.

2. init()이 호출된 후 클라이언트의 요청에 따라서 service() 메소드를 통해 요헝에 대한 응답이 doGet()과 doPost()로 분기됩니다. 이때 서블릿 컨테이너가 클라이언트의 요청이 오면 가장 먼저
   처리하는 과정으로 생성된 HttpServletRequest, HttpServletResponse에 의해 request와 response 객체가 제공됩니다.

3. 컨테이너가 서블릿에 종료 요청을 하면 destory() 메소드가 호출되는데 마찬가지로 한번만 실행되며, 종료시에 처리해야 하는 작업들은 destoroy() 메소드를 오버라이딩하여 구현하면 됩니다.

### 라이프 사이클 메서드

초기화 : init()

- 서블릿 요청 시 맨 처음 한번만 호출됩니다.
- 서블릿 생성 시 초기화 작업을 주로 수행합니다.

작업수행 : doGet(), doPost()

- 서블릿 요청 시 매번 호출됩니다.
- 실제로 클라이언트가 요청하는 작업을 수행합니다.

종료: destroy()

- 서블릿이 기능을 수행하고 메모리에서 소멸될 때 호출됩니다.
- 서블릿의 마무리 작업을 주로 수행합니다.

## 서블릿 컨테이너

:::tip 정의  
구현되어 있는 서블릿 클래스의 규칙에 맞게 서블릿을 담고 관리해주는 컨테이너이다. 클라이언트에서 요청을 하면 컨테이너는 HttpServletRequest, HttpServletResponse 두 객체를 생성하여
post, get 여부에 따라 동적인 페이지를 생성하여 응답을 보낸다.
:::

- 웹 서버와의 통신 지원  
  서블릿 컨테이너는 서블릿과 웹서버가 손쉽게 통신할 수 있게 해줍니다. 일반적으로 소켓을 만들고 listen, accept등을 해야하지만 서블릿 컨테이너는 이러한 기능을 API로 제공하여 복잡한 과정을 생략할 수
  있게 해줍니다. 그래서 개발자가 서블릿에 구현해야 할 비지니스 로직에 대해서만 초점을 두게끔 도와줍니다.

- 서블릿 생명주기 관리  
  서블릿 컨테이너는 서블릿 클래스를 로딩하여 인스턴스화하고, 초기화 메소드를 호출하고, 요청이 들어오면 적절한 서블릿 메소드를 호출합니다. 또한 수명이 다 된 서블릿을 적절하게 가비지 콜렉터를 호출하여 필요없는
  자원 낭비를 막아줍니다.

- 멀티쓰레드 지원 및 관리  
  서블릿 턴테이너는 Request가 올 때마다 새로운 자바 쓰레드를 하나 생성하는데, HTTP 서비스 메소드를 실행하고 나면, 쓰레드는 자동으로 죽게 됩니다. 원래는 쓰레드를 관리해야 하지만 서버가 다중 쓰레드를
  생성 및 운영해주니 쓰레드의 안정성에 대해서 걱정하지 않아도 됩니다.

- 선언적인 보안관리  
  서블릿 컨테이너를 사용하면 개발자는 보안에 관련된 내용을 서블릿 또는 자바 클래스에 구현해 놓지 않아도 됩니다. 일반적으로 보안관리는 xml 배포 서술자에다가 기록하므로, 보안에 대해 수정할 일이 생겨도 자바
  소스 코드를 수정하여 다시 컴파일 하지 않아도 보안관리가 가능합니다.

### 참고자료

- [Song's DLog](https://velog.io/@falling_star3/Tomcat-%EC%84%9C%EB%B8%94%EB%A6%BFServlet%EC%9D%B4%EB%9E%80)
- https://victorydntmd.tistory.com/154